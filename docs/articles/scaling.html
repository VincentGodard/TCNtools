<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scaling  • TCNtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Scaling ">
<meta property="og:description" content="TCNtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TCNtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/scaling.html">Scaling </a>
    </li>
    <li>
      <a href="../articles/concentration_solver.html">Concentration calculations </a>
    </li>
    <li>
      <a href="../articles/two_nuclides_plots.html">2-nuclides plots</a>
    </li>
    <li>
      <a href="../articles/depth_profiles.html">Depth profiles </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scaling_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="scaling_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="scaling_files/anchor-sections-1.0/anchor-sections.js"></script><script src="scaling_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="scaling_files/jquery-1.12.4/jquery.min.js"></script><link href="scaling_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="scaling_files/datatables-binding-0.16/datatables.js"></script><link href="scaling_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="scaling_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="scaling_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="scaling_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="scaling_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Scaling</h1>
                        <h4 class="author">Vincent Godard</h4>
            
            <h4 class="date">2021-11-23</h4>
      
      
      <div class="hidden name"><code>scaling.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<div id="how-to-use-this-document" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-use-this-document" class="anchor"></a>How to use this document?</h2>
<p>This html page is derived from an <a href="http://rmarkdown.rstudio.com">R Markdown</a> Notebook. You can copy/paste the various lines of code into your own R script and run it in any R session.</p>
</div>
<div id="objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#objectives" class="anchor"></a>Objectives</h2>
<p>Our goal is to describe the variations of these scaling factors with latitude and elevation, which are the main parameters controlling the production rates of cosmogenic nuclides at the Earth surface.</p>
<p>The first thing we have to do is to load the <code>TCNtools</code> library (once it has been installed).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"TCNtools"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="time-independent-scaling" class="section level1">
<h1 class="hasAnchor">
<a href="#time-independent-scaling" class="anchor"></a>Time-independent scaling</h1>
<p>We are going to present the most widely used and simplest scaling scheme known as Lal-Stone and often abbreviated as <strong>st</strong>. The main equations are presented in the reference article by <span class="citation">Stone (2000)</span> .</p>
<div id="site-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#site-characteristics" class="anchor"></a>Site characteristics</h2>
<p>We first need to define some parameters concerning the site of interest :</p>
<ul>
<li>latitude <code>lat</code> in degrees</li>
<li>altitude <code>z</code> in meters (can be a vector or a scalar)</li>
<li>longitude <code>lon</code> in degrees, this is not used for <em>st</em> scaling (<span class="citation">Stone (2000)</span>), just in case we want to compute atmospheric pressure according to ERA40 (<span class="citation">Uppala et al. (2005)</span>).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lat</span> <span class="op">=</span> <span class="fl">30</span> <span class="co"># latitude</span>
<span class="va">lon</span> <span class="op">=</span> <span class="fl">30</span> <span class="co"># longitude</span>
<span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3000</span>,by<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># vector from 0 to 3000 m by 100 m increments</span></code></pre></div>
<p>Now we can compute the atmospheric pressure, with the function <code>atm_pressure</code> according to the two models available, and then plot for comparison. Here <code>z</code> is a vector to see the variations over a range of elevations.</p>
<p>To get information about the usage of the function used here (for example what are the different models) type <code><a href="../reference/atm_pressure.html">?atm_pressure</a></code> in the R console.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P1</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> 
<span class="va">P2</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,lat<span class="op">=</span><span class="va">lat</span>,lon<span class="op">=</span><span class="va">lon</span>,model<span class="op">=</span><span class="st">"era40"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">P1</span>,<span class="va">z</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Pressure (hPa)"</span>,ylab<span class="op">=</span><span class="st">"Altitude (m)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">P2</span>,<span class="va">z</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Stone 2000"</span>,<span class="st">"ERA40"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="computation-of-scaling-factors" class="section level2">
<h2 class="hasAnchor">
<a href="#computation-of-scaling-factors" class="anchor"></a>Computation of scaling factors</h2>
<p>We can now compute the scaling factors according to <span class="citation">Stone (2000)</span>. Same as above, to get some information about the function (parameters definition) type <code>?st_scaling</code> in the R console.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P1</span>,<span class="va">lat</span><span class="op">)</span> <span class="co"># here we use the pressure according to Stone 2000 model</span>
<span class="fu">datatable</span><span class="op">(</span><span class="va">st</span><span class="op">)</span><span class="op">%&gt;%</span>  <span class="fu">formatRound</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Nneutrons'</span>,<span class="st">'Nmuons'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> </code></pre></div>
<div id="htmlwidget-911d40867fbd0dd29894" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-911d40867fbd0dd29894">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],[0.83002237518145,0.902663149798947,0.978925824271485,1.05939949796289,1.14466100034036,1.23527587399699,1.33179932556559,1.43477714410543,1.54474658652637,1.66223722960371,1.78777178812609,1.92186689871549,2.06503386885612,2.21777939067287,2.38060621900552,2.5540138133379,2.73849894315501,2.93455625632059,3.14267881009151,3.36335856441319,3.59708683717042,3.84435472110477,4.10565346214795,4.38147479896499,4.67231126354524,4.97865644273122,5.30100520062744,5.63985386188833,5.99570035594136,6.36904432226684,6.76038717691515],[0.833,0.875195062083143,0.919092388980515,0.96473813096996,1.01217867724989,1.06146061322436,1.11263067653776,1.16573571191731,1.22082262488411,1.27793833439806,1.33712972450392,1.39844359504968,1.46192661155102,1.52762525427848,1.59558576664618,1.66585410298368,1.73847587577491,1.81349630244896,1.89096015181083,1.97091169020061,2.05339462747122,2.13845206287619,2.22612643095926,2.31645944753905,2.40949205588144,2.50526437315328,2.60381563725065,2.70518415409464,2.80940724548694,2.91652119761732,3.0265612103133]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Nneutrons<\/th>\n      <th>Nmuons<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script><p>The result is stored in <code>st</code> as a dataframe with as many rows as there are elements in the input pressure vector (<code>P1</code>) and two columns named <code>Nneutrons</code> and <code>Nmuons</code>, for the spallogenic and muogenic contributions, respectively.</p>
<p>We can plot the evolution with elevation, wich illustrates the major influence of altitude of the sampling site in controlling the local production rate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span>,<span class="va">z</span>,type<span class="op">=</span><span class="st">"l"</span>,
     xlab<span class="op">=</span><span class="st">"Spallogenic st scaling factor (Stone 2000)"</span>,ylab<span class="op">=</span><span class="st">"Altitude (m)"</span>,
     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Latitude "</span>,<span class="va">lat</span>,<span class="st">"°"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="global-variations" class="section level2">
<h2 class="hasAnchor">
<a href="#global-variations" class="anchor"></a>Global variations</h2>
<p>In order to get a better idea of the variations with both latitude (from 0 to 90°) and elevation (from sea level to 3000 m) we can try the following plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> <span class="co"># compute pressure</span>
<span class="va">lat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># latitude vector</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span> <span class="co"># size of vector</span>
<span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span> <span class="co"># compute scaling</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">lat</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span>,type<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">12</span><span class="op">)</span>,
     xlab<span class="op">=</span><span class="st">"Latitude (°)"</span>,ylab<span class="op">=</span><span class="st">"Spallogenic st scaling factor (Stone 2000)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">lat</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="st">"0 km"</span>,cex<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="co"># put label at the end of curve</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">z</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span>,<span class="fl">3000</span>,by<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop on elevations : same as above for a range of elevations</span>
  <span class="va">P</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> 
  <span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lat</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">lat</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">z</span><span class="op">/</span><span class="fl">1000</span>,cex<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>This dependance of the scaling factor on latitude is a direct consequence of the dipole nature structure of the Earth magnetic field, with a higher cosmic rays flux at high latitude.</p>
</div>
</div>
<div id="time-dependent-scalings" class="section level1">
<h1 class="hasAnchor">
<a href="#time-dependent-scalings" class="anchor"></a>Time-dependent scalings</h1>
<div id="definition-of-paleomagnetic-variations" class="section level2">
<h2 class="hasAnchor">
<a href="#definition-of-paleomagnetic-variations" class="anchor"></a>Definition of paleomagnetic variations</h2>
<p>Time-dependent scaling factors allow to take into account the variations through time of the Earth magnetic field, which modulates the incoming cosmic ray flux.</p>
<div id="virtual-dipole-moment" class="section level3">
<h3 class="hasAnchor">
<a href="#virtual-dipole-moment" class="anchor"></a>Virtual Dipole Moment</h3>
<p>We need to first define a time series for the Virtual Dipole Moment (VDM) variation, using the <code>get_vdm</code> function.</p>
<p>Several paleomagnetic database can be used. The three options correspond to databases defined in <a href="https://crep.otelo.univ-lorraine.fr">Crep</a>. We plot the three of them on the same graph.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5e4</span>,length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># time vector from 0 to 50 ka BP, with 1000 regularly spaced elements</span>
<span class="co">#</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"VDM (10^22 A.m^2)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># - Glopis</span>
<span class="va">col1</span><span class="op">=</span><span class="st">"coral1"</span>
<span class="va">vdm1</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"glopis"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm1</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col1</span><span class="op">)</span>
<span class="co"># 2 - Musch</span>
<span class="va">col2</span> <span class="op">=</span> <span class="st">"chartreuse"</span>
<span class="va">vdm2</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"musch"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm2</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col2</span><span class="op">)</span>
<span class="co"># 3 - lsd</span>
<span class="va">col3</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>
<span class="va">vdm3</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"lsd"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm3</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"glopis"</span>,<span class="st">"musch"</span>,<span class="st">"lsd"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">col1</span>,<span class="va">col2</span>,<span class="va">col3</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="cutoff-rigidity" class="section level3">
<h3 class="hasAnchor">
<a href="#cutoff-rigidity" class="anchor"></a>Cutoff Rigidity</h3>
<p>Now we need to convert that into cutoff rigidity using <code>vdm2rc</code> function. Such can be done using the following expression (<span class="citation">Martin et al. (2017)</span>): <span class="math display">\[R_c = 14.3 \frac{M}{M_0}\cos^4 \lambda,\]</span> where <span class="math inline">\(M\)</span> is the moment of the Earth dipole field, <span class="math inline">\(M_0\)</span> the 2010 reference value for <span class="math inline">\(M\)</span> and <span class="math inline">\(\lambda\)</span> the latitude. This corresponds to the default <code>model=elsasser54</code> in the <code>vdm2rc</code> function arguments. A more complex formula proposed by <span class="citation">Lifton, Sato, and Dunai (2014)</span> can be used with <code>model=lifton14</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lat</span> <span class="op">=</span> <span class="fl">40</span>
<span class="va">rc1a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm1</span>,<span class="va">lat</span><span class="op">)</span>
<span class="va">rc1b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm1</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span>
<span class="va">rc2a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm2</span>,<span class="va">lat</span><span class="op">)</span>
<span class="va">rc2b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm2</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span>
<span class="va">rc3a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm3</span>,<span class="va">lat</span><span class="op">)</span>
<span class="va">rc3b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm3</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span>
<span class="co">#</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">rc1a</span>,<span class="va">rc2a</span>,<span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">rc3a</span><span class="op">)</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"Rc (GV)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc1a</span>,col<span class="op">=</span><span class="va">col1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc1b</span>,col<span class="op">=</span><span class="va">col1</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc2a</span>,col<span class="op">=</span><span class="va">col2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc2b</span>,col<span class="op">=</span><span class="va">col2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc3a</span>,col<span class="op">=</span><span class="va">col3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc3b</span>,col<span class="op">=</span><span class="va">col3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"glopis"</span>,<span class="st">"musch"</span>,<span class="st">"lsd"</span>,<span class="st">"elsasser54"</span>,<span class="st">"lifton14"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">col1</span>,<span class="va">col2</span>,<span class="va">col3</span>,<span class="st">"black"</span>,<span class="st">"black"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div id="lalstone-modified-scaling-lm" class="section level2">
<h2 class="hasAnchor">
<a href="#lalstone-modified-scaling-lm" class="anchor"></a>Lal/Stone modified scaling (<em>lm</em>)</h2>
<p>Once we have a <span class="math inline">\(R_c\)</span> time series we can compute the <em>lm</em> scaling factors using the <code>scaling_lm</code> function. For that we will only use one elevation (<em>z=0</em>), so we recompute the atmospheric pressure. We plot the corresponding time series, as well as the value of <em>st</em> scaling factor for reference.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P</span> <span class="op">=</span> <span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span>
<span class="va">lm</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_lm.html">scaling_lm</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">rc1a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">lm</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"Spallogenic lm scaling factor"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span><span class="op">$</span><span class="va">Nneutrons</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="lsd-scaling-sa-and-sf" class="section level2">
<h2 class="hasAnchor">
<a href="#lsd-scaling-sa-and-sf" class="anchor"></a>LSD scaling (<em>sa</em> and <em>sf</em>)</h2>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-lifton2014scaling">
<p>Lifton, Nathaniel, Tatsuhiko Sato, and Tibor J. Dunai. 2014. “Scaling in situ cosmogenic nuclide production rates using analytical approximations to atmospheric cosmic-ray fluxes.” <em>Earth and Planetary Science Letters</em> 386: 149–60. <a href="https://doi.org/10.1016/j.epsl.2013.10.052">https://doi.org/10.1016/j.epsl.2013.10.052</a>.</p>
</div>
<div id="ref-martin2017crep">
<p>Martin, L. C. P., P.-H. Blard, G. Balco, J. Lavé, R. Delunel, N. Lifton, and V. Laurent. 2017. “The CREp program and the ICE-D production rate calibration database: A fully parameterizable and updated online tool to compute cosmic-ray exposure ages.” <em>Quaternary Geochronology</em> 38 (March): 25–49. <a href="https://doi.org/10.1016/j.quageo.2016.11.006">https://doi.org/10.1016/j.quageo.2016.11.006</a>.</p>
</div>
<div id="ref-stone2000air">
<p>Stone, John O. 2000. “Air pressure and cosmogenic isotope production.” <em>Journal of Geophysical Research: Solid Earth</em> 105 (B10): 23753–9. <a href="https://doi.org/10.1029/2000JB900181">https://doi.org/10.1029/2000JB900181</a>.</p>
</div>
<div id="ref-uppala2005era40">
<p>Uppala, S. M., P. W. KÅllberg, Adrian J. Simmons, U. Andrae, V. Da Costa Bechtold, M. Fiorino, J. K. Gibson, et al. 2005. “The ERA-40 re-analysis.” <em>Quarterly Journal of the Royal Meteorological Society</em> 131 (612): 2961–3012. <a href="https://doi.org/10.1256/qj.04.176">https://doi.org/10.1256/qj.04.176</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Vincent Godard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
