<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scaling  • TCNtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Scaling ">
<meta property="og:description" content="TCNtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TCNtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/scaling.html">Scaling </a>
    </li>
    <li>
      <a href="../articles/concentration_solver.html">Concentration calculations </a>
    </li>
    <li>
      <a href="../articles/two_nuclides_plots.html">2-nuclides plots</a>
    </li>
    <li>
      <a href="../articles/depth_profiles.html">Depth profiles </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Scaling</h1>
                        <h4 data-toc-skip class="author">Vincent
Godard</h4>
            
            <h4 data-toc-skip class="date">2022-10-06</h4>
      
      
      <div class="hidden name"><code>scaling.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="how-to-use-this-document">How to use this document?<a class="anchor" aria-label="anchor" href="#how-to-use-this-document"></a>
</h3>
<p>This html page is derived from an <a href="http://rmarkdown.rstudio.com" class="external-link">R Markdown</a> Notebook. You can
copy/paste the various lines of code into your own R script and run it
in any R session.</p>
</div>
<div class="section level3">
<h3 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h3>
<p>Our goal is to describe the variations of these scaling factors with
latitude and elevation, which are the main parameters controlling the
production rates of cosmogenic nuclides at the Earth surface.</p>
<p>The first thing we have to do is to load the <code>TCNtools</code>
library (once it has been installed).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"TCNtools"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="time-independent-scaling">Time-independent scaling<a class="anchor" aria-label="anchor" href="#time-independent-scaling"></a>
</h2>
<p>We are going to present the most widely used and simplest scaling
scheme known as Lal-Stone and often abbreviated as <strong>st</strong>.
The main equations are presented in the reference article by <span class="citation">Stone (2000)</span> .</p>
<div class="section level3">
<h3 id="site-characteristics">Site characteristics<a class="anchor" aria-label="anchor" href="#site-characteristics"></a>
</h3>
<p>We first need to define some parameters concerning the site of
interest :</p>
<ul>
<li>latitude <code>lat</code> in degrees</li>
<li>altitude <code>z</code> in meters (can be a vector or a scalar)</li>
<li>longitude <code>lon</code> in degrees, this is not used for
<em>st</em> scaling (<span class="citation">Stone (2000)</span>), just
in case we want to compute atmospheric pressure according to ERA40
(<span class="citation">Uppala et al. (2005)</span>).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lat</span> <span class="op">=</span> <span class="fl">30</span> <span class="co"># latitude</span></span>
<span><span class="va">lon</span> <span class="op">=</span> <span class="fl">30</span> <span class="co"># longitude</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3000</span>,by<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># vector from 0 to 3000 m by 100 m increments</span></span></code></pre></div>
<p>Now we can compute the atmospheric pressure, with the function
<code>atm_pressure</code> according to the two models available, and
then plot for comparison. Here <code>z</code> is a vector to see the
variations over a range of elevations.</p>
<p>To get information about the usage of the function used here (for
example what are the different models) type <code><a href="../reference/atm_pressure.html">?atm_pressure</a></code>
in the R console.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P1</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> </span>
<span><span class="va">P2</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,lat<span class="op">=</span><span class="va">lat</span>,lon<span class="op">=</span><span class="va">lon</span>,model<span class="op">=</span><span class="st">"era40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P1</span>,<span class="va">z</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Pressure (hPa)"</span>,ylab<span class="op">=</span><span class="st">"Altitude (m)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">P2</span>,<span class="va">z</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Stone 2000"</span>,<span class="st">"ERA40"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="computation-of-scaling-factors">Computation of scaling factors<a class="anchor" aria-label="anchor" href="#computation-of-scaling-factors"></a>
</h3>
<p>We can now compute the scaling factors according to <span class="citation">Stone (2000)</span>. Same as above, to get some
information about the function (parameters definition) type
<code>?st_scaling</code> in the R console.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P1</span>,<span class="va">lat</span><span class="op">)</span> <span class="co"># here we use the pressure according to Stone 2000 model</span></span></code></pre></div>
<p>The result is stored in <code>st</code> as a dataframe with as many
rows as there are elements in the input pressure vector
(<code>P1</code>) and two columns named <code>Nneutrons</code> and
<code>Nmuons</code>, for the spallogenic and muogenic contributions,
respectively.</p>
<p>We can plot the evolution with elevation, wich illustrates the major
influence of altitude of the sampling site in controlling the local
production rate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span>,<span class="va">z</span>,type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Spallogenic st scaling factor (Stone 2000)"</span>,ylab<span class="op">=</span><span class="st">"Altitude (m)"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Latitude "</span>,<span class="va">lat</span>,<span class="st">"°"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="global-variations">Global variations<a class="anchor" aria-label="anchor" href="#global-variations"></a>
</h3>
<p>In order to get a better idea of the variations with both latitude
(from 0 to 90°) and elevation (from sea level to 3000 m) we can try the
following plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> <span class="co"># compute pressure</span></span>
<span><span class="va">lat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># latitude vector</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span> <span class="co"># size of vector</span></span>
<span><span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span> <span class="co"># compute scaling</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lat</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span>,type<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">12</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Latitude (°)"</span>,ylab<span class="op">=</span><span class="st">"Spallogenic st scaling factor (Stone 2000)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">lat</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="st">"0 km"</span>,cex<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="co"># put label at the end of curve</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">z</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>,<span class="fl">3000</span>,by<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop on elevations : same as above for a range of elevations</span></span>
<span>  <span class="va">P</span><span class="op">=</span><span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">z</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> </span>
<span>  <span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lat</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">lat</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">st</span><span class="op">$</span><span class="va">Nneutrons</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,<span class="va">z</span><span class="op">/</span><span class="fl">1000</span>,cex<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>This dependance of the scaling factor on latitude is a direct
consequence of the dipole nature structure of the Earth magnetic field,
with a higher cosmic rays flux at high latitude.</p>
</div>
</div>
<div class="section level2">
<h2 id="time-dependent-scalings">Time-dependent scalings<a class="anchor" aria-label="anchor" href="#time-dependent-scalings"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-paleomagnetic-variations">Definition of paleomagnetic variations<a class="anchor" aria-label="anchor" href="#definition-of-paleomagnetic-variations"></a>
</h3>
<p>Time-dependent scaling factors allow to take into account the
variations through time of the Earth magnetic field, which modulates the
incoming cosmic ray flux.</p>
<div class="section level4">
<h4 id="virtual-dipole-moment">Virtual Dipole Moment<a class="anchor" aria-label="anchor" href="#virtual-dipole-moment"></a>
</h4>
<p>We need to first define a time series for the Virtual Dipole Moment
(VDM) variation, using the <code>get_vdm</code> function.</p>
<p>Several paleomagnetic database can be used. The three options
correspond to databases defined in <a href="https://crep.otelo.univ-lorraine.fr" class="external-link">Crep</a>. We plot the three
of them on the same graph.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5e4</span>,length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># time vector from 0 to 50 ka BP, with 1000 regularly spaced elements</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"VDM (10^22 A.m^2)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># - Glopis</span></span>
<span><span class="va">col1</span><span class="op">=</span><span class="st">"coral1"</span></span>
<span><span class="va">vdm1</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"glopis"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm1</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col1</span><span class="op">)</span></span>
<span><span class="co"># 2 - Musch</span></span>
<span><span class="va">col2</span> <span class="op">=</span> <span class="st">"chartreuse"</span></span>
<span><span class="va">vdm2</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"musch"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm2</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col2</span><span class="op">)</span></span>
<span><span class="co"># 3 - lsd</span></span>
<span><span class="va">col3</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span></span>
<span><span class="va">vdm3</span><span class="op">=</span><span class="fu"><a href="../reference/get_vdm.html">get_vdm</a></span><span class="op">(</span><span class="va">time</span>,model<span class="op">=</span><span class="st">"lsd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">vdm3</span><span class="op">/</span><span class="fl">1e22</span>,col<span class="op">=</span><span class="va">col3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glopis"</span>,<span class="st">"musch"</span>,<span class="st">"lsd"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col1</span>,<span class="va">col2</span>,<span class="va">col3</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="cutoff-rigidity">Cutoff Rigidity<a class="anchor" aria-label="anchor" href="#cutoff-rigidity"></a>
</h4>
<p>Now we need to convert that into cutoff rigidity using
<code>vdm2rc</code> function. Such can be done using the following
expression (<span class="citation">Martin et al. (2017)</span>): <span class="math display">\[R_c = 14.3 \frac{M}{M_0}\cos^4 \lambda,\]</span>
where <span class="math inline">\(M\)</span> is the moment of the Earth
dipole field, <span class="math inline">\(M_0\)</span> the 2010
reference value for <span class="math inline">\(M\)</span> and <span class="math inline">\(\lambda\)</span> the latitude. This corresponds to
the default <code>model=elsasser54</code> in the <code>vdm2rc</code>
function arguments. A more complex formula proposed by <span class="citation">Lifton, Sato, and Dunai (2014)</span> can be used with
<code>model=lifton14</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lat</span> <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="va">rc1a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm1</span>,<span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">rc1b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm1</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span></span>
<span><span class="va">rc2a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm2</span>,<span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">rc2b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm2</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span></span>
<span><span class="va">rc3a</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm3</span>,<span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">rc3b</span> <span class="op">=</span> <span class="fu"><a href="../reference/vdm2rc.html">vdm2rc</a></span><span class="op">(</span><span class="va">vdm3</span>,<span class="va">lat</span>,model<span class="op">=</span><span class="st">"lifton14"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rc1a</span>,<span class="va">rc2a</span>,<span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">rc3a</span><span class="op">)</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"Rc (GV)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc1a</span>,col<span class="op">=</span><span class="va">col1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc1b</span>,col<span class="op">=</span><span class="va">col1</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc2a</span>,col<span class="op">=</span><span class="va">col2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc2b</span>,col<span class="op">=</span><span class="va">col2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc3a</span>,col<span class="op">=</span><span class="va">col3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">rc3b</span>,col<span class="op">=</span><span class="va">col3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glopis"</span>,<span class="st">"musch"</span>,<span class="st">"lsd"</span>,<span class="st">"elsasser54"</span>,<span class="st">"lifton14"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col1</span>,<span class="va">col2</span>,<span class="va">col3</span>,<span class="st">"black"</span>,<span class="st">"black"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="lalstone-modified-scaling-lm">Lal/Stone modified scaling (<em>lm</em>)<a class="anchor" aria-label="anchor" href="#lalstone-modified-scaling-lm"></a>
</h3>
<p>Once we have a <span class="math inline">\(R_c\)</span> time series
we can compute the <em>lm</em> scaling factors using the
<code>scaling_lm</code> function. For that we will only use one
elevation (<em>z=0</em>), so we recompute the atmospheric pressure. We
plot the corresponding time series, as well as the value of <em>st</em>
scaling factor for reference.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">=</span> <span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span></span>
<span><span class="va">lm</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_lm.html">scaling_lm</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">rc1a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">lm</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Time (a BP)"</span>,ylab<span class="op">=</span><span class="st">"Spallogenic lm scaling factor"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">lat</span><span class="op">)</span><span class="op">$</span><span class="va">Nneutrons</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="scaling_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="lsd-scaling-sa-and-sf">LSD scaling (<em>sa</em> and <em>sf</em>)<a class="anchor" aria-label="anchor" href="#lsd-scaling-sa-and-sf"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lifton2014scaling" class="csl-entry">
Lifton, Nathaniel, Tatsuhiko Sato, and Tibor J. Dunai. 2014.
<span>“Scaling in Situ Cosmogenic Nuclide Production Rates Using
Analytical Approximations to Atmospheric Cosmic-Ray Fluxes.”</span>
<em>Earth and Planetary Science Letters</em> 386: 149–60. <a href="https://doi.org/f5r46p" class="external-link">https://doi.org/f5r46p</a>.
</div>
<div id="ref-martin2017crep" class="csl-entry">
Martin, L. C. P., P.-H. Blard, G. Balco, J. Lavé, R. Delunel, N. Lifton,
and V. Laurent. 2017. <span>“The <span>CREp</span> Program and the
<span>ICE</span>-<span>D</span> Production Rate Calibration Database:
<span>A</span> Fully Parameterizable and Updated Online Tool to Compute
Cosmic-Ray Exposure Ages.”</span> <em>Quaternary Geochronology</em> 38
(March): 25–49. <a href="https://doi.org/f92pbm" class="external-link">https://doi.org/f92pbm</a>.
</div>
<div id="ref-stone2000air" class="csl-entry">
Stone, John O. 2000. <span>“Air Pressure and Cosmogenic Isotope
Production.”</span> <em>Journal of Geophysical Research: Solid
Earth</em> 105 (B10): 23753–59. <a href="https://doi.org/fbsd87" class="external-link">https://doi.org/fbsd87</a>.
</div>
<div id="ref-uppala2005era40" class="csl-entry">
Uppala, S. M., P. W. KÅllberg, Adrian J. Simmons, U. Andrae, V. Da Costa
Bechtold, M. Fiorino, J. K. Gibson, et al. 2005. <span>“The
<span>ERA</span>-40 Re-Analysis.”</span> <em>Quarterly Journal of the
Royal Meteorological Society</em> 131 (612): 2961–3012. <a href="https://doi.org/fthgs7" class="external-link">https://doi.org/fthgs7</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vincent Godard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
