<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concentration calculations  • TCNtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Concentration calculations ">
<meta property="og:description" content="TCNtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TCNtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/scaling.html">Scaling </a>
    </li>
    <li>
      <a href="../articles/concentration_solver.html">Concentration calculations </a>
    </li>
    <li>
      <a href="../articles/two_nuclides_plots.html">2-nuclides plots</a>
    </li>
    <li>
      <a href="../articles/depth_profiles.html">Depth profiles </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Concentration calculations</h1>
                        <h4 data-toc-skip class="author">Vincent
Godard</h4>
            
            <h4 data-toc-skip class="date">2022-10-06</h4>
      
      
      <div class="hidden name"><code>concentration_solver.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="how-to-use-this-document">How to use this document?<a class="anchor" aria-label="anchor" href="#how-to-use-this-document"></a>
</h3>
<p>This html page is derived from an <a href="http://rmarkdown.rstudio.com" class="external-link">R Markdown</a> Notebook. You can
copy/paste the various lines of code into your own R script and run it
in any R session.</p>
</div>
<div class="section level3">
<h3 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h3>
<p>The objective of this notbook is to illustrate simple computations of
concentration.</p>
<p>The first thing we have to do is to load the <code>TCNtools</code>
library (once it has been installed)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"TCNtools"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simple-calcutions-with-the-eulerian-approach">Simple calcutions with the Eulerian approach<a class="anchor" aria-label="anchor" href="#simple-calcutions-with-the-eulerian-approach"></a>
</h2>
<p>We are going to consider simple computations of concentration under
various conditions in terms of erosion, depth or age. This will be done
using an Eulerian point of view, which is the most straightforward and
fastest way to perform such computation. In this case the quantity of
interest (concentration) is computed at fixed depths below the surface,
while the exhumed material is moving through this reference frame during
its trajectory toward the surface. More details on the differences
between Eulerian and Lagrangian approaches, and their application to
complex exposition/denudation histories, will be studied later.</p>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>The relevant equation is the following,</p>
<p><span class="math display">\[
C=C_0e^{-\lambda t} + \sum_i \frac{P_i}{\frac{\rho
\varepsilon}{\Lambda_i}+\lambda}e^{\frac{-\rho
z}{\Lambda_i}}(1-e^{-(\frac{\rho \varepsilon}{\Lambda_i}+\lambda)t})
\]</span> with the following variables and parameters,</p>
<ul>
<li>
<span class="math inline">\(C\)</span> the concentration (as a
function of time <span class="math inline">\(t\)</span> and depth <span class="math inline">\(z\)</span>)</li>
<li>
<span class="math inline">\(C_0\)</span> the inherited
concentration</li>
<li>
<span class="math inline">\(\lambda\)</span> the decay constant for
the considered nuclide</li>
<li>
<span class="math inline">\(P_i\)</span> the scaled surface
production rate for the nuclide of interest and the <span class="math inline">\(i\)</span>-th production pathway (spallation,
stopped muons, fast muons)</li>
<li>
<span class="math inline">\(\rho\)</span> the density of the
medium</li>
<li>
<span class="math inline">\(\Lambda_i\)</span> the attenuation
length for the particules of the <span class="math inline">\(i\)</span>-th production pathway</li>
<li>
<span class="math inline">\(\varepsilon\)</span> surface
denudation</li>
</ul>
<p>In order to stick with usual conventions in the following time will
be measured in years (a), the unit of length will be cm and the depths
will be expressed in g/cm<span class="math inline">\(^2\)</span>
(i.e. actual depth <span class="math inline">\(\times
\rho\)</span>).</p>
</div>
<div class="section level3">
<h3 id="set-up-of-the-calculations">Set up of the calculations<a class="anchor" aria-label="anchor" href="#set-up-of-the-calculations"></a>
</h3>
<p>We should the define the basic parameters we are going to use for the
computation, which are two vectors :</p>
<ul>
<li>a vector with the attenuation lengths for different particules (in
g/cm<span class="math inline">\(^2\)</span>)
<ul>
<li>neutrons for spallation reactions <span class="math inline">\(\Lambda_{spal}\)</span>
</li>
<li>stopping muons <span class="math inline">\(\Lambda_{stop}\)</span>
</li>
<li>fast muons <span class="math inline">\(\Lambda_{fast}\)</span><br>
</li>
</ul>
</li>
<li>a vector (or matrix) with the SLHL production rates (in at/g/a), in
this case for the <em>st</em> scaling scheme (<span class="citation">Stone (2000)</span>), and decay constant <span class="math inline">\(\lambda\)</span> (in 1/a) for the nuclide(s) of
interest.</li>
</ul>
<p>For easy reference a set of data for these parameters is included in
the <code>TCNtools</code> package, including Sea-Level High-Latitude
production rates for the <code>st</code> scaling scheme.</p>
<p>We can first load the attenuation length data (g/cm<span class="math inline">\(^2\)</span>). Documentation of this dataset is
accessible with <code><a href="../reference/Lambda.html">?Lambda</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Lambda</span><span class="op">)</span> <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Lambda</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Lspal Lstop Lfast </span></span>
<span><span class="co">##   160  1500  4320</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rho</span> <span class="op">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span></code></pre></div>
<p>The the production and decay parameters. Documentation of this
dataset is accessible with <code><a href="../reference/prm.html">?prm</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prm</span><span class="op">)</span> <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               Be10         Al26          C14</span></span>
<span><span class="co">## Pspal  4.01000e+00 2.793000e+01 1.224000e+01</span></span>
<span><span class="co">## Pstop  1.20000e-02 8.400000e-01 3.310000e+00</span></span>
<span><span class="co">## Pfast  3.90000e-02 8.100000e-02 0.000000e+00</span></span>
<span><span class="co">## lambda 5.09667e-07 9.667325e-07 1.209681e-04</span></span></code></pre>
<p>We also need to define the properties of our site of interest and
compute the relevant scaling parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">altitude</span> <span class="op">=</span> <span class="fl">1000</span> <span class="co"># elevation in m</span></span>
<span><span class="va">latitude</span> <span class="op">=</span> <span class="fl">45</span> <span class="co"># latitude in degrees</span></span>
<span><span class="va">P</span> <span class="op">=</span> <span class="fu"><a href="../reference/atm_pressure.html">atm_pressure</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">altitude</span>,model<span class="op">=</span><span class="st">"stone2000"</span><span class="op">)</span> <span class="co"># compute atmospheric pressure at site</span></span>
<span><span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="../reference/scaling_st.html">scaling_st</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">latitude</span><span class="op">)</span> <span class="co"># compute the scaling parameters according to Stone (2000)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="concentration-along-a-profile">Concentration along a profile<a class="anchor" aria-label="anchor" href="#concentration-along-a-profile"></a>
</h3>
<p>We first compute the changes in concentration with depth <span class="math inline">\(z\)</span> along a profile. We are going to use
the <code>solv_conc_eul</code> function. As always the notice of the
function, including its various arguments, can be obtained by typing
<code><a href="../reference/solv_conc_eul.html">?solv_conc_eul</a></code> in the R console. We consider no inheritance
(<span class="math inline">\(C_0\)</span>=0), so the evolution is
starting from a profile with homogeneous zero concentration.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="va">rho</span> <span class="co"># a vector containing depth from 0 to 500 cm by 10 cm increments,  and then converted into g/cm2</span></span>
<span><span class="va">C0</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># inherited concentration</span></span>
<span><span class="va">age</span> <span class="op">=</span> <span class="fl">10000</span> <span class="co"># the time in a</span></span>
<span><span class="va">ero</span> <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">100</span><span class="op">/</span><span class="fl">1e6</span><span class="op">*</span><span class="va">rho</span> <span class="co"># denudation rate expressed in m/Ma and converted in g/cm2/a</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="va">z</span>,<span class="va">ero</span>,<span class="va">age</span>,<span class="va">C0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">"Be10"</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span> <span class="co"># compute concentration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="va">z</span>,type<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">3</span>,col<span class="op">=</span><span class="st">"coral"</span>,xlab<span class="op">=</span><span class="st">"Concentration (at/g)"</span>,ylab<span class="op">=</span><span class="st">"Depth (g/cm2)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="concentration_solver_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Try to modify the <code>age</code> and <code>ero</code> (always
keeping it in g/cm<span class="math inline">\(^2\)</span>/a) parameters
above, to see their influence on the profile.</p>
</div>
<div class="section level3">
<h3 id="evolution-of-concentration-with-time">Evolution of concentration with time<a class="anchor" aria-label="anchor" href="#evolution-of-concentration-with-time"></a>
</h3>
<p>Now we are going to consider the evolution of concentration with time
<span class="math inline">\(t\)</span>. The computation will be carried
out at the surface (<span class="math inline">\(z=0\)</span>), but this
could be done at any arbitrary depth.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100e3</span>,by<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># a vector containing time from 0 to 100 ka by 100 a steps</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">*</span> <span class="va">rho</span> <span class="co"># depth at which we are going to perform the calculation (cm converted to g/cm2)</span></span>
<span><span class="va">C0</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># inherited concentration</span></span>
<span><span class="va">ero</span> <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">100</span><span class="op">/</span><span class="fl">1e6</span><span class="op">*</span><span class="va">rho</span> <span class="co"># denudation rate expressed in m/Ma and converted in g/cm2/a</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="va">z</span>,<span class="va">ero</span>,<span class="va">age</span>,<span class="va">C0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">"Be10"</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span> <span class="co"># compute concentration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">1000</span>,<span class="va">C</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="st">"cornflowerblue"</span>,lwd<span class="op">=</span><span class="fl">3</span>,ylab<span class="op">=</span><span class="st">"Concentration (at/g)"</span>,xlab<span class="op">=</span><span class="st">"Time (ka)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="concentration_solver_files/figure-html/ck_5-1.png" width="700"></p>
<p>We see here the progressive build-up of concentration though time and
the establishment of balance between gains (production) and losses
(denudation and decay) leading to the concentration plateau at steady
state.</p>
<p>Try to modify the <code>ero</code> (always keeping it in g/cm<span class="math inline">\(^2\)</span>/a) parameter above, to see its
influence on time needed to reach steady state and the final
concentration.</p>
</div>
<div class="section level3">
<h3 id="evolution-of-concentration-with-denudation-rate">Evolution of concentration with denudation rate<a class="anchor" aria-label="anchor" href="#evolution-of-concentration-with-denudation-rate"></a>
</h3>
<p>Now we are going to consider the evolution of concentration with
denudation rate <span class="math inline">\(\varepsilon\)</span>. The
computation will be carried out at the surface (<span class="math inline">\(z=0\)</span>), but this could be done at any
arbitrary depth. We will consider that <span class="math inline">\(t=+\infty\)</span> and that we have reached the
plateau concentration.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ero</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">/</span><span class="fl">1e6</span><span class="op">*</span><span class="va">rho</span> <span class="co"># a log-spaced vector for denudation rate expressed in m/Ma and converted in g/cm2/a</span></span>
<span><span class="va">age</span> <span class="op">=</span>  <span class="cn">Inf</span> <span class="co"># infinite age</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">*</span> <span class="va">rho</span> <span class="co"># depth at which we are going to perform the calculation (cm converted to g/cm2)</span></span>
<span><span class="va">C0</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># inherited concentration</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="va">z</span>,<span class="va">ero</span>,<span class="va">age</span>,<span class="va">C0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">"Be10"</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span> <span class="co"># compute concentration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ero</span><span class="op">/</span><span class="fl">100</span><span class="op">*</span><span class="fl">1e6</span><span class="op">/</span><span class="va">rho</span>,<span class="va">C</span>,col<span class="op">=</span><span class="st">"lawngreen"</span>,log<span class="op">=</span><span class="st">"xy"</span>,type<span class="op">=</span><span class="st">"l"</span>,lwd<span class="op">=</span><span class="fl">3</span>,ylab<span class="op">=</span><span class="st">"Concentration (at/g)"</span>,xlab<span class="op">=</span><span class="st">"Denudation rate (m/Ma)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="concentration_solver_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>This figure (log-scales on both axes) highlights the strong inverse
relationship, at steady-state, between denudation rate (<span class="math inline">\(\varepsilon\)</span>) and concentration (<span class="math inline">\(C\)</span>), which is the foundation of many
geomorphological studies trying to establish landscape evolution rates.
Note the change in the relationship at very low denudation rates, which
corresponds to the situation where the effects of radioactive decay
become predominant.</p>
</div>
<div class="section level3">
<h3 id="dealing-with-inheritance">Dealing with inheritance<a class="anchor" aria-label="anchor" href="#dealing-with-inheritance"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="comparing-the-eulerian-and-lagrangian-descriptions">Comparing the Eulerian and Lagrangian descriptions<a class="anchor" aria-label="anchor" href="#comparing-the-eulerian-and-lagrangian-descriptions"></a>
</h2>
<p>This section presents a simple comparison of the Eulerian and
Lagrangian approaches for the computation of cosmogenic nuclides
concentration evolution in complex denudation and exposure scenarios. A
nice presentation of this distinction is provided in <span class="citation">(<strong>knudsen2019time?</strong>)</span>.</p>
<div class="section level3">
<h3 id="definition-of-the-denudation-scenario">Definition of the denudation scenario<a class="anchor" aria-label="anchor" href="#definition-of-the-denudation-scenario"></a>
</h3>
<p>We will start from a steady state situation under constant
denudation, and then apply a change in the denudation rate for a given
period of time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmax</span> <span class="op">=</span> <span class="fl">2e6</span> <span class="co"># duration in a </span></span>
<span><span class="va">ero</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1.e6</span><span class="op">*</span><span class="fl">100</span><span class="op">*</span><span class="va">rho</span> <span class="co"># denudation rate conversion en m/Ma -&gt; g/cm2/a</span></span>
<span><span class="va">fact</span> <span class="op">=</span> <span class="fl">5</span> <span class="co"># change factor</span></span></code></pre></div>
<p>Here the duration of the simulation will be 2 Ma, the initial
denudation rate will be 1 m/Ma, which will changed by a factor 5 at the
beginning of the simulation.</p>
</div>
<div class="section level3">
<h3 id="computation-of-concentrations">Computation of concentrations<a class="anchor" aria-label="anchor" href="#computation-of-concentrations"></a>
</h3>
<div class="section level4">
<h4 id="eulerian-reference-frame">Eulerian reference frame<a class="anchor" aria-label="anchor" href="#eulerian-reference-frame"></a>
</h4>
<p>We compute the evolution of concentrations at the surface (<span class="math inline">\(z=0\)</span>) using an Eulerian point of view. The
calculation is very straightforward thanks to the
<code>solv_conc_eul</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">tmax</span>,length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span> <span class="co"># data frame to store results</span></span>
<span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span><span class="op">=</span><span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ero</span><span class="op">*</span><span class="va">fact</span>,<span class="va">df_e</span><span class="op">$</span><span class="va">t</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">"Be10"</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span>,in_ero<span class="op">=</span><span class="va">ero</span><span class="op">)</span></span>
<span><span class="va">df_e</span><span class="op">$</span><span class="va">C26</span><span class="op">=</span><span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ero</span><span class="op">*</span><span class="va">fact</span>,<span class="va">df_e</span><span class="op">$</span><span class="va">t</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">"Al26"</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span>,in_ero<span class="op">=</span><span class="va">ero</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="lagrangian-reference-frame">Lagrangian reference frame<a class="anchor" aria-label="anchor" href="#lagrangian-reference-frame"></a>
</h4>
<p>Now we do the same calculation using a Lagrangian point of view,
i.e. with a reference frame attached to a rock particle during its
journey toward the surface as a response to denudation. It is slightly
more complicated than in the Eulerian case and is done using the
<code>solv_conc_lag</code> function.</p>
<p>We first initiate a dataframe (<code>df_l</code>) and compute the
evolution in depth <code>z</code> of the particle through time when it
is exhumed from its initial depth (here 10 m) to the surface at a rate 5
m/Ma.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_l</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">tmax</span>,length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span> <span class="co"># data frame to store results</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span> <span class="op">=</span> <span class="va">ero</span><span class="op">*</span><span class="va">fact</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">t</span> <span class="co"># cumulative erosion trough time (g/cm2)</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">)</span> <span class="op">-</span> <span class="va">df_l</span><span class="op">$</span><span class="va">z</span> <span class="co"># convert into depth</span></span></code></pre></div>
<p>We compute the steady state concentration at starting depth, using
the Eulerian solver.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C10_0</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>,<span class="va">ero</span>,<span class="cn">Inf</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Be10'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span> <span class="co"># starting 10Be concentration</span></span>
<span><span class="va">C26_0</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>,<span class="va">ero</span>,<span class="cn">Inf</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Al26'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span> <span class="co"># starting 26Al concentration</span></span></code></pre></div>
<p>We then define another column in the data frame with the evolution of
scaling parameters through time. It is trivial here in the case of the
time-independent <strong>st</strong> scaling, but it will be highly
valuable when dealing with time-dependent scalings, where the Eulerian
approach is not applicable.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_l</span><span class="op">$</span><span class="va">Ssp</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">)</span><span class="op">)</span> <span class="co"># scaling spallation</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">Smu</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">)</span><span class="op">)</span> <span class="co"># scaling muons</span></span></code></pre></div>
<p>Then we calculate the un-scaled production rates at depths the depths
of interest. Here again, as we use simple models of exponential decrease
for production with depth, the interest of using such Lagrangian
approach is not obvious. But such way of computing concentration will
allow to deal with non-exponential production profiles, which might
necessary in some situation for muons or low-energy neutrons.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10Be (not scaled)</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">Psp10</span> <span class="op">=</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pspal"</span>,<span class="st">'Be10'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lspal"</span><span class="op">]</span><span class="op">)</span> <span class="co"># spallation</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">Pmu10</span> <span class="op">=</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pstop"</span>,<span class="st">'Be10'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lstop"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pfast"</span>,<span class="st">'Be10'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lfast"</span><span class="op">]</span><span class="op">)</span> <span class="co"># muons</span></span>
<span><span class="co"># 26Al (not scaled)</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">Psp26</span> <span class="op">=</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pspal"</span>,<span class="st">'Al26'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lspal"</span><span class="op">]</span><span class="op">)</span> <span class="co"># spallation</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">Pmu26</span> <span class="op">=</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pstop"</span>,<span class="st">'Al26'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lstop"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">prm</span><span class="op">[</span><span class="st">"Pfast"</span>,<span class="st">'Al26'</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">df_l</span><span class="op">$</span><span class="va">z</span><span class="op">/</span><span class="va">Lambda</span><span class="op">[</span><span class="st">"Lfast"</span><span class="op">]</span><span class="op">)</span> <span class="co"># muons</span></span></code></pre></div>
<p>We can now use the <code>solv_conc_lag</code> function to compute the
evolution of concentration through time and depth.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_l</span><span class="op">$</span><span class="va">C10</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_lag.html">solv_conc_lag</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">t</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">z</span>,<span class="va">C10_0</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Psp10</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Pmu10</span>,<span class="va">prm</span><span class="op">[</span><span class="st">"lambda"</span>,<span class="st">'Be10'</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">Ssp</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Smu</span><span class="op">)</span>,final<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df_l</span><span class="op">$</span><span class="va">C26</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_lag.html">solv_conc_lag</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">t</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">z</span>,<span class="va">C26_0</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Psp26</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Pmu26</span>,<span class="va">prm</span><span class="op">[</span><span class="st">"lambda"</span>,<span class="st">'Al26'</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">Ssp</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">Smu</span><span class="op">)</span>,final<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-results">Comparison of results<a class="anchor" aria-label="anchor" href="#comparison-of-results"></a>
</h3>
<p>We can now plot the results of the calculations and compare the two
approaches. First for <span class="math inline">\(^{10}\)</span>Be.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col_e</span> <span class="op">=</span> <span class="st">"chartreuse"</span></span>
<span><span class="va">col_l</span> <span class="op">=</span> <span class="st">"chocolate1"</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">t</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_e</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="va">col_e</span>,lwd<span class="op">=</span><span class="fl">2</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">t</span><span class="op">/</span><span class="fl">1e6</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time (Ma)"</span>,ylab<span class="op">=</span><span class="st">"10Be concentration (x10e6 at/g)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">t</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,col<span class="op">=</span><span class="va">col_l</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eulerian"</span>,<span class="st">"Lagrangian"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_e</span>,<span class="va">col_l</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="concentration_solver_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The Lagrangian evolution starts with a low concentration
corresponding to the burial at depth of the particle at the onset of the
evolution, while at the same time (<span class="math inline">\(t=0\)</span>) we are looking at the surface with
the Eulerian point of view, and then obviously observe much higher
concentrations. The two descriptions converge toward the same
concentration at the end of the evolution (i.e. when the lagrangian
particle reaches the surface).</p>
<p>We can also represent the corresponding two nuclides plot for <span class="math inline">\(^{10}\)</span>Be and <span class="math inline">\(^{26}\)</span>Al. We need first to compute the
steady-state erosion and constant exposure lines.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># steady state erosion lines</span></span>
<span><span class="va">erosion</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">0.0001</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span>,length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">/</span><span class="fl">1.e6</span><span class="op">*</span><span class="fl">100</span><span class="op">*</span><span class="va">rho</span> <span class="co">#  m/Ma -&gt; g/cm2/a</span></span>
<span><span class="va">C10Be</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">erosion</span>,<span class="cn">Inf</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Be10'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="va">C26Al</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">erosion</span>,<span class="cn">Inf</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Al26'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="va">ss_erosion</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ero</span>,<span class="va">C10Be</span>,<span class="va">C26Al</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot banana line ss exposure</span></span>
<span><span class="va">time</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">200e6</span><span class="op">)</span>,length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># a</span></span>
<span><span class="va">C10Be</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">time</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Be10'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="va">C26Al</span> <span class="op">=</span> <span class="fu"><a href="../reference/solv_conc_eul.html">solv_conc_eul</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">time</span>,<span class="fl">0</span>,<span class="va">prm</span><span class="op">[</span>,<span class="st">'Al26'</span><span class="op">]</span>,<span class="va">S</span>,<span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="va">ss_exposure</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">C10Be</span>,<span class="va">C26Al</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span></code></pre></div>
<p>And then plot.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span><span class="op">)</span>,log<span class="op">=</span><span class="st">"x"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">C26</span><span class="op">/</span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">C26</span><span class="op">/</span><span class="va">df_l</span><span class="op">$</span><span class="va">C10</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"10Be concentration (x10e6 at/g)"</span>,ylab<span class="op">=</span><span class="st">"26Al/10Be"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ss_erosion</span><span class="op">$</span><span class="va">C10Be</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">ss_erosion</span><span class="op">$</span><span class="va">C26Al</span><span class="op">/</span><span class="va">ss_erosion</span><span class="op">$</span><span class="va">C10Be</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ss_exposure</span><span class="op">$</span><span class="va">C10Be</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">ss_exposure</span><span class="op">$</span><span class="va">C26Al</span><span class="op">/</span><span class="va">ss_exposure</span><span class="op">$</span><span class="va">C10Be</span>,col<span class="op">=</span><span class="st">"black"</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_e</span><span class="op">$</span><span class="va">C26</span><span class="op">/</span><span class="va">df_e</span><span class="op">$</span><span class="va">C10</span>,col<span class="op">=</span><span class="va">col_e</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">df_l</span><span class="op">$</span><span class="va">C10</span><span class="op">/</span><span class="fl">1e6</span>,<span class="va">df_l</span><span class="op">$</span><span class="va">C26</span><span class="op">/</span><span class="va">df_l</span><span class="op">$</span><span class="va">C10</span>,col<span class="op">=</span><span class="va">col_l</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eulerian"</span>,<span class="st">"Lagrangian"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_e</span>,<span class="va">col_l</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="concentration_solver_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Note that the steady-state erosion and constant exposure lines are
only relevant for the Eulerian trajectory.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-stone2000air" class="csl-entry">
Stone, John O. 2000. <span>“Air Pressure and Cosmogenic Isotope
Production.”</span> <em>Journal of Geophysical Research: Solid
Earth</em> 105 (B10): 23753–59. <a href="https://doi.org/fbsd87" class="external-link">https://doi.org/fbsd87</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vincent Godard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
